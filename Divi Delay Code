jQuery(document).ready(function ($) {
    var delayTime = 120000; // 2 minutes
    var intervalTime = 30000; // 30 seconds

    console.log('Script initialized');

    function handleDiviSlider() {
        $('.et_pb_slider').each(function(index) {
            var slider = $(this);
            console.log('Found Divi slider:', index);

            // Initial pause
            slider.attr('data-autoplay', 'false');
            console.log('Initial autoplay disabled');

            // Force immediate reinit
            if (typeof et_pb_reinit_waypoint_modules === "function") {
                et_pb_reinit_waypoint_modules();
                console.log('Forced initial waypoint reinit');
            }

            setTimeout(function() {
                console.log('Initial delay completed, enabling autoplay');
                slider.attr('data-autoplay', 'true');

                if (typeof et_pb_reinit_waypoint_modules === "function") {
                    et_pb_reinit_waypoint_modules();
                    console.log('Slider reinitialized after delay');
                }

                setInterval(function() {
                    console.log('Interval triggered - disabling autoplay');
                    slider.attr('data-autoplay', 'false');

                    setTimeout(function() {
                        console.log('Short interval completed - enabling autoplay');
                        slider.attr('data-autoplay', 'true');
                        if (typeof et_pb_reinit_waypoint_modules === "function") {
                            et_pb_reinit_waypoint_modules();
                            console.log('Slider reinitialized in interval');
                        }
                    }, intervalTime);

                }, delayTime + intervalTime);
            }, delayTime);
        });
    }

    // Run on both document ready and window load
    handleDiviSlider();
    $(window).on('load', handleDiviSlider);
});
